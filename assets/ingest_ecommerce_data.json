{"name":"ingest_ecommerce_data","ppdf:dataflowId":"63bf18c8-225e-4494-92e1-6592e3062e46","ppdf:owner":{"tenantId":"e1169ac2-b523-4393-9611-277fdb28f609","userId":"7beea0a7-9906-49d6-9efd-92bd3342d0c8"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-IN","modifiedTime":"2025-09-23T09:47:29.7459091+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"data":{"queryId":"7dc536a2-8fd1-46f9-aa3b-80ce6fabf291","queryName":"data"},"data_DataDestination":{"queryId":"192caed1-3246-4b44-8aaf-b6bbe663459d","queryName":"data_DataDestination"},"data_WriteToDataDestination":{"queryId":"d23e3c4d-e681-4345-83c9-046506267051","queryName":"data_WriteToDataDestination"},"data_TransformForWriteToDataDestination":{"queryId":"04d1253c-0a6f-4e81-a7c4-cd2fef7bd2fb","queryName":"data_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"d7ebac44-465d-40a0-b8cc-33d0574036c8","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared data = let\r\n  Source = GoogleSheets.Contents(\"https://docs.google.com/spreadsheets/d/18RYHkmp6yWEsnZZa3ZMTkTHhq_s3rkgFcHBz2pvYeMg/edit?usp=sharing\"),\r\n  #\"Navigation 1\" = Source{[name = \"data\", ItemKind = \"Table\"]}[Data],\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Navigation 1\", [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"Description\", type text}, {\"Quantity\", Int64.Type}, {\"InvoiceDate\", type datetime}, {\"UnitPrice\", type number}, {\"CustomerID\", Int64.Type}, {\"Country\", type text}}),\r\n  #\"Inserted First Characters\" = Table.AddColumn(#\"Changed column type\", \"First Characters\", each Text.Start(Text.From([StockCode], \"en-IN\"), 5), type text),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Inserted First Characters\", {{\"First Characters\", \"Stockcodenew\"}}),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Renamed columns\", {\"StockCode\"}),\r\n  #\"Replaced value\" = Table.ReplaceValue(#\"Removed columns\", null, null, Replacer.ReplaceValue, {\"Quantity\"}),\r\n  #\"Replaced value 1\" = Table.ReplaceValue(#\"Replaced value\", null, null, Replacer.ReplaceValue, {\"UnitPrice\"}),\r\n  #\"Sorted rows\" = Table.Sort(#\"Replaced value 1\", {{\"Quantity\", Order.Ascending}}),\r\n  #\"Inserted Absolute Value\" = Table.AddColumn(#\"Sorted rows\", \"new_quantity\", each Number.Abs([Quantity]), type number),\r\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Inserted Absolute Value\", {\"Quantity\"}),\r\n  #\"Changed column type 1\" = Table.TransformColumnTypes(#\"Removed columns 1\", {{\"UnitPrice\", type number}, {\"new_quantity\", type number}}),\r\n  #\"Added custom\" = Table.AddColumn(#\"Changed column type 1\", \"price\", each [new_quantity] * [UnitPrice]),\r\n  #\"Changed column type 2\" = Table.TransformColumnTypes(#\"Added custom\", {{\"price\", type number}}),\r\n  #\"Inserted Last Characters\" = Table.AddColumn(#\"Changed column type 2\", \"Last Characters\", each Text.End(Text.From([InvoiceNo], \"en-IN\"), 6), type text),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Inserted Last Characters\", {{\"Last Characters\", \"inv_number\"}})\r\nin\r\n  #\"Renamed columns 1\";\r\nshared data_DataDestination = let\r\n  Pattern = Lakehouse.Contents([HierarchicalNavigation = null, CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"82ebaddc-7284-4f2e-8ccd-8b2f8e6c6953\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"81637b00-98cf-497b-922f-35eda16cd9f9\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"sales_raw\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Description = nullable Text.Type, InvoiceDate = nullable DateTime.Type, UnitPrice = nullable Number.Type, CustomerID = nullable Int64.Type, Country = nullable Text.Type, Stockcodenew = nullable Text.Type, new_quantity = nullable Number.Type, price = nullable Number.Type, inv_number = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared data_WriteToDataDestination = let\r\n  data_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = data_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], data_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  data_WriteToDataDestination;\r\nshared data_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(data, {\"Description\", \"InvoiceDate\", \"UnitPrice\", \"CustomerID\", \"Country\", \"Stockcodenew\", \"new_quantity\", \"price\", \"inv_number\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"https://docs.google.com/spreadsheets/d/18RYHkmp6yWEsnZZa3ZMTkTHhq_s3rkgFcHBz2pvYeMg/edit?usp=sharing","kind":"GoogleSheets","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"GoogleSheets\",\"path\":\"https://docs.google.com/spreadsheets/d/18RYHkmp6yWEsnZZa3ZMTkTHhq_s3rkgFcHBz2pvYeMg/edit?usp=sharing\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}],"trustedConnections":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}